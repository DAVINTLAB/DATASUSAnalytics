[
  {
    "id": "GT001",
    "difficulty": "easy",
    "question": "Quantas internações foram registradas no total?",
    "query": "SELECT COUNT(*) AS total_internacoes FROM internacoes;",
    "tables": [
      "internacoes"
    ],
    "notes": "Main table - 11M+ records"
  },
  {
    "id": "GT002",
    "difficulty": "easy",
    "question": "Quantas mortes foram registradas?",
    "query": "SELECT COUNT(*) AS total_mortes FROM mortes;",
    "tables": [
      "mortes"
    ],
    "notes": "CRITICAL: Use mortes table, not internacoes - 569k records"
  },
  {
    "id": "GT003",
    "difficulty": "easy",
    "question": "Quantos procedimentos diferentes existem cadastrados?",
    "query": "SELECT COUNT(*) AS total_procedimentos FROM procedimentos;",
    "tables": [
      "procedimentos"
    ],
    "notes": "CRITICAL: Use procedimentos table, not cid10 - 5.4k records"
  },
  {
    "id": "GT004",
    "difficulty": "easy",
    "question": "Quantos códigos CID-10 estão disponíveis?",
    "query": "SELECT COUNT(*) AS total_cids FROM cid10;",
    "tables": [
      "cid10"
    ],
    "notes": "Reference table only - 14.2k codes"
  },
  {
    "id": "GT005",
    "difficulty": "easy",
    "question": "Quantos hospitais estão cadastrados?",
    "query": "SELECT COUNT(*) AS total_hospitais FROM hospital;",
    "tables": [
      "hospital"
    ],
    "notes": "Hospital reference data"
  },
  {
    "id": "GT006",
    "difficulty": "easy",
    "question": "Quantos municípios têm dados demográficos do IBGE?",
    "query": "SELECT COUNT(*) AS total_municipios FROM dado_ibge;",
    "tables": [
      "dado_ibge"
    ],
    "notes": "CRITICAL: Use dado_ibge, not municipios - 5.5k records"
  },
  {
    "id": "GT007",
    "difficulty": "easy",
    "question": "Quantos registros de UTI existem?",
    "query": "SELECT COUNT(*) AS total_uti FROM uti_detalhes;",
    "tables": [
      "uti_detalhes"
    ],
    "notes": "CRITICAL: UTI-specific table often missed - 81k records"
  },
  {
    "id": "GT008",
    "difficulty": "easy",
    "question": "Quantos casos de condições especiais foram registrados?",
    "query": "SELECT COUNT(*) AS total_condicoes FROM condicoes_especificas;",
    "tables": [
      "condicoes_especificas"
    ],
    "notes": "Special medical conditions - 1.1M records"
  },
  {
    "id": "GT009",
    "difficulty": "easy",
    "question": "Quantos registros CBOR existem?",
    "query": "SELECT COUNT(*) AS total_cbor FROM cbor;",
    "tables": [
      "cbor"
    ],
    "notes": "CBOR classification - 6.4k records"
  },
  {
    "id": "GT010",
    "difficulty": "easy",
    "question": "Quantos casos obstétricos foram registrados?",
    "query": "SELECT COUNT(*) AS total_obstetricos FROM obstetricos;",
    "tables": [
      "obstetricos"
    ],
    "notes": "Pregnancy/childbirth specific data"
  },
  {
    "id": "GT011",
    "difficulty": "easy",
    "question": "Quantos registros de vínculo previdenciário temos?",
    "query": "SELECT COUNT(*) AS total_vincprev FROM vincprev;",
    "tables": [
      "vincprev"
    ],
    "notes": "Social security linkage data"
  },
  {
    "id": "GT012",
    "difficulty": "easy",
    "question": "Quantos registros de instrução educacional existem?",
    "query": "SELECT COUNT(*) AS total_instrucao FROM instrucao;",
    "tables": [
      "instrucao"
    ],
    "notes": "Education level data"
  },
  {
    "id": "GT013",
    "difficulty": "medium",
    "question": "Quantos pacientes do sexo masculino foram internados?",
    "query": "SELECT COUNT(*) AS homens FROM internacoes WHERE \"SEXO\" = 1;",
    "tables": [
      "internacoes"
    ],
    "notes": "Gender filtering in main table - SEXO=1 for male"
  },
  {
    "id": "GT014",
    "difficulty": "medium",
    "question": "Quantas internações por meningite ocasionaram em morte?",
    "query": "SELECT COUNT(mo.\"N_AIH\") FROM mortes mo JOIN internacoes i ON mo.\"N_AIH\" = i.\"N_AIH\" JOIN cid10 c ON mo.\"CID_MORTE\" = c.\"CID\" WHERE c.\"CD_DESCRICAO\" ILIKE '%meningite%' AND mo.\"N_AIH\" IS NOT NULL;",
    "tables": [
      "mortes",
      "internacoes",
      "cid10"
    ],
    "notes": "CRITICAL: Conte óbitos em mortes e selecione causas via JOIN com cid10 (CID_MORTE → CID) filtrando por descrições cardiovasculares; evite depender apenas de prefixos de código"
  },
  {
    "id": "GT015",
    "difficulty": "medium",
    "question": "Qual a descrição do código CID A15?",
    "query": "SELECT \"CD_DESCRICAO\" FROM cid10 WHERE \"CID\" = 'A15';",
    "tables": [
      "cid10"
    ],
    "notes": "Reference lookup in CID table"
  },
  {
    "id": "GT016",
    "difficulty": "medium",
    "question": "Quantos casos de VDRL positivo foram registrados?",
    "query": "SELECT COUNT(*) AS vdrl_positivo FROM condicoes_especificas WHERE \"IND_VDRL\" = '1';",
    "tables": [
      "condicoes_especificas"
    ],
    "notes": "Specific condition filtering"
  },
  {
    "id": "GT017",
    "difficulty": "medium",
    "question": "Qual o tempo médio de permanência hospitalar?",
    "query": "SELECT AVG(\"QT_DIARIAS\") AS tempo_medio_uti FROM internacoes;",
    "tables": [
      "uti_detalhes"
    ],
    "notes": "CRITICAL: UTI-specific calculations"
  },
  {
    "id": "GT018",
    "difficulty": "medium",
    "question": "Qual município tem a maior população segundo dados do IBGE?",
    "query": "SELECT nome_municipio FROM dado_ibge WHERE populacao IS NOT NULL ORDER BY populacao DESC LIMIT 1;",
    "tables": [
      "dado_ibge"
    ],
    "notes": "CRITICAL: Use dado_ibge for demographic data"
  },
  {
    "id": "GT019",
    "difficulty": "medium",
    "question": "\"Quais os cinco municípios com mais internações obstétricas registradas?",
    "query": " SELECT mu.nome, COUNT(o.\"N_AIH\") AS total_internacoes FROM obstetricos o JOIN internacoes i ON o.\"N_AIH\" = i.\"N_AIH\" JOIN municipios mu ON i.\"MUNIC_RES\" = mu.codigo_6d GROUP BY mu.nome ORDER BY total_internacoes DESC LIMIT 5;",
    "tables": [
      "obstetricos",
      "internacoes",
      "municipios"
    ],
    "notes": "Obstetric-specific filtering"
  },
  {
    "id": "GT020",
    "difficulty": "hard",
    "question": "Quantas internações resultaram em óbito?",
    "query": "SELECT COUNT(DISTINCT i.\"N_AIH\") AS internacoes_com_obito FROM internacoes i INNER JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\";",
    "tables": [
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: Link internações to deaths"
  },
  {
    "id": "GT021",
    "difficulty": "hard",
    "question": "Quais são os 5 procedimentos mais comuns (baseado em códigos únicos)?",
    "query": " SELECT \"PROC_REA\" AS procedimento, COUNT(DISTINCT i.\"N_AIH\") AS total_internacoes FROM internacoes i GROUP BY \"PROC_REA\" ORDER BY total_internacoes DESC LIMIT 5;",
    "tables": [
      "internacoes"
    ],
    "notes": "Most common procedures by code frequency"
  },
  {
    "id": "GT022",
    "difficulty": "hard",
    "question": "Quantos hospitais registraram pelo menos uma morte?",
    "query": "SELECT COUNT(DISTINCT h.\"CNES\") AS hospitais_com_mortes FROM hospital h JOIN internacoes i ON h.\"CNES\" = i.\"CNES\" JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\";",
    "tables": [
      "hospital",
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: 3-table join for hospital mortality"
  },
  {
    "id": "GT023",
    "difficulty": "hard",
    "question": "Quantas internações de UTI resultaram em óbito?",
    "query": "SELECT COUNT(DISTINCT u.\"N_AIH\") AS uti_com_obito FROM uti_detalhes u JOIN mortes m ON u.\"N_AIH\" = m.\"N_AIH\";",
    "tables": [
      "uti_detalhes",
      "mortes"
    ],
    "notes": "JOIN: UTI cases with death outcome"
  },
  {
    "id": "GT024",
    "difficulty": "hard",
    "question": "Quais hospitais têm mais de 1000 internações registradas?",
    "query": "SELECT h.\"CNES\", COUNT(i.\"N_AIH\") AS total_internacoes FROM hospital h JOIN internacoes i ON h.\"CNES\" = i.\"CNES\" GROUP BY h.\"CNES\" HAVING COUNT(i.\"N_AIH\") > 1000 ORDER BY total_internacoes DESC;",
    "tables": [
      "hospital",
      "internacoes"
    ],
    "notes": "JOIN: Hospital activity volume"
  },
  {
    "id": "GT025",
    "difficulty": "hard",
    "question": "Quantas internações com condições especiais resultaram em morte?",
    "query": "SELECT COUNT(DISTINCT c.\"N_AIH\") AS condicoes_com_obito FROM condicoes_especificas c JOIN mortes m ON c.\"N_AIH\" = m.\"N_AIH\";",
    "tables": [
      "condicoes_especificas",
      "mortes"
    ],
    "notes": "JOIN: Special conditions with mortality"
  },
  {
    "id": "GT026",
    "difficulty": "hard",
    "question": "Qual o valor médio das internações que resultaram em óbito?",
    "query": "SELECT AVG(i.\"VAL_TOT\") AS valor_medio_obitos FROM internacoes i JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\" WHERE i.\"VAL_TOT\" IS NOT NULL;",
    "tables": [
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: Financial impact of fatal cases"
  },
  {
    "id": "GT027",
    "difficulty": "hard",
    "question": "Quantos casos CBOR tiveram acompanhamento em UTI?",
    "query": "SELECT COUNT(DISTINCT c.\"N_AIH\") AS cbor_com_uti FROM cbor c JOIN uti_detalhes u ON c.\"N_AIH\" = u.\"N_AIH\";",
    "tables": [
      "cbor",
      "uti_detalhes"
    ],
    "notes": "JOIN: CBOR classification with ICU care"
  },
  {
    "id": "GT028",
    "difficulty": "hard",
    "question": "Qual a taxa de mortalidade por município (top 10)?",
    "query": "SELECT i.\"MUNIC_RES\", COUNT(DISTINCT i.\"N_AIH\") as internacoes, COUNT(DISTINCT m.\"N_AIH\") as mortes, ROUND(COUNT(DISTINCT m.\"N_AIH\")::numeric / COUNT(DISTINCT i.\"N_AIH\") * 100, 2) as taxa_mortalidade FROM internacoes i LEFT JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\" WHERE i.\"MUNIC_RES\" IS NOT NULL GROUP BY i.\"MUNIC_RES\" HAVING COUNT(DISTINCT i.\"N_AIH\") > 100 ORDER BY taxa_mortalidade DESC LIMIT 10;",
    "tables": [
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: Complex mortality rate calculation"
  },
  {
    "id": "GT030",
    "difficulty": "medium",
    "question": "Qual é o valor médio de UTI para homens?",
    "query": "SELECT AVG(u.\"VAL_UTI\") AS valor_medio_uti_homens FROM uti_detalhes u JOIN internacoes i ON u.\"N_AIH\" = i.\"N_AIH\" WHERE i.\"SEXO\" = 1 AND u.\"VAL_UTI\" IS NOT NULL;",
    "tables": [
      "internacoes",
      "uti_detalhes"
    ]
  },
  {
    "id": "GT031",
    "difficulty": "easy",
    "question": "Quantas mulheres foram internadas?",
    "query": "SELECT COUNT(*) AS total_mulheres FROM internacoes WHERE \"SEXO\" = 3;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT032",
    "difficulty": "easy",
    "question": "Qual a latitude e longitude de Porto Alegre?",
    "query": "SELECT latitude, longitude FROM municipios WHERE nome = 'Porto Alegre';",
    "tables": [
      "municipios"
    ]
  },
  {
    "id": "GT033",
    "difficulty": "easy",
    "question": "Quantos municípios estão no estado do RS?",
    "query": "SELECT COUNT(*) AS municipios_rs FROM municipios WHERE estado = 'RS';",
    "tables": [
      "municipios"
    ]
  },
  {
    "id": "GT034",
    "difficulty": "easy",
    "question": "Qual a idade média dos pacientes internados?",
    "query": "SELECT AVG(\"IDADE\") AS idade_media FROM internacoes WHERE \"IDADE\" IS NOT NULL;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT035",
    "difficulty": "easy",
    "question": "Quantas internações duraram mais de 30 dias?",
    "query": " SELECT COUNT(*) FROM internacoes i WHERE i.\"QT_DIARIAS\" > 30;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT037",
    "difficulty": "medium",
    "question": "Qual o diagnóstico mais comum nas internações?",
    "query": "SELECT c.\"CD_DESCRICAO\" AS diagnostico, COUNT(*) AS total FROM internacoes i JOIN cid10 c ON i.\"DIAG_PRINC\" = c.\"CID\" WHERE i.\"DIAG_PRINC\" IS NOT NULL GROUP BY c.\"CD_DESCRICAO\" ORDER BY total DESC LIMIT 1;",
    "tables": [
      "internacoes",
      "cid10"
    ],
    "notes": "JOIN with cid10 to return human-readable diagnosis name instead of code"
  },
  {
    "id": "GT038",
    "difficulty": "medium",
    "question": "Quantas internações ocorreram em 2015?",
    "query": "SELECT COUNT(*) AS internacoes_2015 FROM internacoes WHERE EXTRACT(YEAR FROM \"DT_INTER\") = 2015;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT040",
    "difficulty": "medium",
    "question": "Quantos pacientes nasceram antes de 1950?",
    "query": "SELECT COUNT(*) AS nascidos_antes_1950 FROM internacoes WHERE EXTRACT(YEAR FROM \"NASC\") < 1950;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT041",
    "difficulty": "medium",
    "question": "Qual município teve o maior número de internações masculinas em 2020?",
    "query": "SELECT mu.nome, COUNT(i.\"N_AIH\") AS total_internacoes FROM internacoes i JOIN municipios mu ON i.\"MUNIC_RES\" = mu.codigo_6d WHERE EXTRACT(YEAR FROM i.\"DT_INTER\") = 2020 AND i.\"SEXO\" = 1 GROUP BY mu.nome ORDER BY total_internacoes DESC LIMIT 1;",
    "tables": [
      "municipios",
      "internacoes"
    ]
  },
  {
    "id": "GT042",
    "difficulty": "medium",
    "question": "Quais são as três causas de morte mais frequentes entre mulheres?",
    "query": "SELECT c.\"CD_DESCRICAO\", COUNT(mo.\"N_AIH\") AS total_mortes FROM cid10 c JOIN mortes mo ON c.\"CID\" = mo.\"CID_MORTE\" JOIN internacoes i ON mo.\"N_AIH\" = i.\"N_AIH\" WHERE i.\"SEXO\" = 3 AND mo.\"CID_MORTE\" IS NOT NULL GROUP BY c.\"CD_DESCRICAO\" ORDER BY total_mortes DESC LIMIT 3;",
    "tables": [
      "internacoes",
      "mortes",
      "cid10"
    ]
  },
  {
    "id": "GT043",
    "difficulty": "medium",
    "question": "Qual a taxa de mortalidade infantil média no Brasil?",
    "query": "SELECT AVG(mortalidade_infantil) AS taxa_media_mortalidade_infantil FROM dado_ibge WHERE mortalidade_infantil IS NOT NULL;",
    "tables": [
      "dado_ibge"
    ]
  },
  {
    "id": "GT044",
    "difficulty": "hard",
    "question": "Quantos hospitais ficam em municípios com mais de 100k habitantes?",
    "query": "SELECT COUNT(DISTINCT h.\"CNES\") AS hospitais_grandes_municipios FROM hospital h JOIN internacoes i ON h.\"CNES\" = i.\"CNES\" JOIN municipios m ON i.\"MUNIC_RES\" = m.codigo_6d JOIN dado_ibge d ON m.codigo_ibge = d.codigo_municipio_completo WHERE d.populacao > 100;",
    "tables": [
      "hospital",
      "internacoes",
      "municipios",
      "dado_ibge"
    ]
  },
  {
    "id": "GT045",
    "difficulty": "medium",
    "question": "Quantas internações de pacientes com mais de 70 anos ocorreram no inverno (junho a agosto)?",
    "query": " SELECT COUNT(i.\"N_AIH\") FROM internacoes i JOIN cid10 c ON i.\"DIAG_PRINC\" = c.\"CID\" WHERE EXTRACT(MONTH FROM i.\"DT_INTER\") BETWEEN 6 AND 8 AND i.\"IDADE\" > 70;",
    "tables": [
      "internacoes",
      "municipios",
      "dados_ibge"
    ]
  },
  {
    "id": "GT046",
    "difficulty": "medium",
    "question": "Quantas internações tiveram tanto diagnóstico principal quanto secundário?",
    "query": "SELECT COUNT(*) AS com_ambos_diagnosticos FROM internacoes WHERE \"DIAG_PRINC\" IS NOT NULL AND \"DIAG_SECUN\" IS NOT NULL;",
    "tables": [
      "internacoes"
    ]
  },
  {
    "id": "GT047",
    "difficulty": "hard",
    "question": "Qual o custo médio de UTI por faixa etária dos pacientes?",
    "query": "SELECT CASE WHEN i.\"IDADE\" < 18 THEN 'Menor' WHEN i.\"IDADE\" < 60 THEN 'Adulto' ELSE 'Idoso' END AS faixa_etaria, AVG(u.\"VAL_UTI\") AS custo_medio_uti FROM internacoes i JOIN uti_detalhes u ON i.\"N_AIH\" = u.\"N_AIH\" WHERE i.\"IDADE\" IS NOT NULL AND u.\"VAL_UTI\" IS NOT NULL GROUP BY CASE WHEN i.\"IDADE\" < 18 THEN 'Menor' WHEN i.\"IDADE\" < 60 THEN 'Adulto' ELSE 'Idoso' END;",
    "tables": [
      "internacoes",
      "uti_detalhes"
    ]
  },
  {
    "id": "GT049",
    "difficulty": "hard",
    "question": "Quantos casos tiveram VDRL positivo e evoluíram para óbito?",
    "query": "SELECT COUNT(DISTINCT c.\"N_AIH\") AS vdrl_positivo_obito FROM condicoes_especificas c JOIN mortes m ON c.\"N_AIH\" = m.\"N_AIH\" WHERE c.\"IND_VDRL\" = '1';",
    "tables": [
      "condicoes_especificas",
      "mortes"
    ]
  },
  {
    "id": "GT050",
    "difficulty": "medium",
    "question": "Qual a evolução de internações para cada ano?",
    "query": "SELECT EXTRACT(YEAR FROM \"DT_INTER\") AS ano, COUNT(*) AS total_internacoes FROM internacoes WHERE \"DT_INTER\" IS NOT NULL GROUP BY ano ORDER BY ano;",
    "tables": [
      "internacoes"
    ],
    "notes": "Temporal trend analysis - important for healthcare planning"
  },
  {
    "id": "GT051",
    "difficulty": "medium",
    "question": "Quantas internações por doença respiratória ocorrem no inverno (junho a agosto)?",
    "query": "SELECT COUNT(*) AS internacoes_respiratorias_inverno FROM internacoes WHERE \"DIAG_PRINC\" LIKE 'J%' AND EXTRACT(MONTH FROM \"DT_INTER\") IN (6, 7, 8);",
    "tables": [
      "internacoes"
    ],
    "notes": "Seasonal analysis - respiratory diseases peak in winter (Southern Hemisphere)"
  },
  {
    "id": "GT052",
    "difficulty": "hard",
    "question": "Quais são as 10 principais causas de morte (com descrição)?",
    "query": "SELECT c.\"CID\", c.\"CD_DESCRICAO\", COUNT(*) AS total_mortes FROM mortes m JOIN cid10 c ON m.\"CID_MORTE\" = c.\"CID\" GROUP BY c.\"CID\", c.\"CD_DESCRICAO\" ORDER BY total_mortes DESC LIMIT 10;",
    "tables": [
      "mortes",
      "cid10"
    ],
    "notes": "JOIN: Critical for public health policy prioritization"
  },
  {
    "id": "GT053",
    "difficulty": "hard",
    "question": "Qual a taxa de mortalidade hospitalar geral do Rio Grande do Sul?",
    "query": "SELECT ROUND((COUNT(DISTINCT m.\"N_AIH\")::numeric / COUNT(DISTINCT i.\"N_AIH\") * 100), 2) AS taxa_mortalidade_perc FROM internacoes i LEFT JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\";",
    "tables": [
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: Key healthcare quality indicator - overall hospital mortality rate"
  },
  {
    "id": "GT054",
    "difficulty": "medium",
    "question": "Qual a taxa de mortalidade para faixa etária 30-45?",
    "query": "SELECT '30-45 anos' AS faixa_etaria, COUNT(DISTINCT i.\"N_AIH\") AS total_internacoes, COUNT(DISTINCT m.\"N_AIH\") AS total_mortes, ROUND(COUNT(DISTINCT m.\"N_AIH\")::numeric / COUNT(DISTINCT i.\"N_AIH\") * 100, 2) AS taxa_mortalidade FROM internacoes i LEFT JOIN mortes m ON i.\"N_AIH\" = m.\"N_AIH\" WHERE i.\"IDADE\" BETWEEN 30 AND 45;",
    "tables": [
      "internacoes",
      "mortes"
    ],
    "notes": "JOIN: Mortality rate for specific age group (30-45 years) - uses BETWEEN for age filtering"
  },
  {
    "id": "GT055",
    "difficulty": "hard",
    "question": "Quais são os 10 municípios com mais internações?",
    "query": "SELECT m.nome AS municipio, COUNT(i.\"N_AIH\") AS total_internacoes FROM internacoes i JOIN municipios m ON i.\"MUNIC_RES\" = m.codigo_6d GROUP BY m.nome ORDER BY total_internacoes DESC LIMIT 10;",
    "tables": [
      "internacoes",
      "municipios"
    ],
    "notes": "JOIN: Regional equity analysis - infrastructure planning"
  }
]
